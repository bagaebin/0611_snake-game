# Requirements Specification

## Overview
이 문서는 자이로센서를 활용한 아이소메트릭 모바일 웹 게임의 요구 사항을 정의합니다. 게임은 16x16 격자 위에서 진행되며, 사용자는 기기의 기울기를 통해 캐릭터의 진행 방향을 제어합니다. 코인을 획득해 몸집을 키우는 것이 주요 메커니즘입니다.

## 사용자 시나리오
- **모바일 플레이어**: 스마트폰에서 브라우저로 접속해 게임을 플레이하는 사용자. 터치 입력 없이 기울기만으로 조작합니다.
- **데스크톱 플레이어 (보조 시나리오)**: 개발 및 테스트를 위해 키보드로도 조작이 가능해야 합니다.

## 사용자 스토리와 수락 기준

### 1. 게임 진입
- **스토리**: 플레이어로서, 게임에 접속하면 모바일 최적화 UI와 3D 씬이 즉시 보이길 원한다.
- **수락 기준**:
  - 페이지 로드 시 전체 화면을 활용하는 3D 캔버스가 표시된다.
  - 게임 규칙 및 기울기 허용 요청을 위한 안내 텍스트가 초기 화면에 노출된다.
  - iOS를 포함한 모바일 브라우저에서 자이로센서 권한 요청을 트리거하는 버튼이 제공된다.

### 2. 캐릭터 초기화
- **스토리**: 플레이어로서, 캐릭터가 무작위 위치에서 시작하되 16x16 격자 내부에 있어야 한다.
- **수락 기준**:
  - 격자 크기는 16x16 셀이며, 각 셀은 균일한 크기다.
  - 게임 시작 시 캐릭터 헤드는 한 셀을 완전히 차지하고, 선택된 셀 내부 중심에서 생성된다.
  - 캐릭터는 최소 1개의 세그먼트(헤드)를 가진다.

### 3. 지속 이동
- **스토리**: 플레이어로서, 캐릭터가 항상 전방으로 움직여 멈추지 않길 원한다.
- **수락 기준**:
  - 초당 일정 속도로 전방 이동이 지속된다.
  - 기본 이동 속도는 초당 4타일(이전 8타일 대비 0.5배)로 설정돼 난이도를 완화한다.
  - 장치 기울기를 변경하면 부드럽게 진행 방향이 변경된다.
  - 데스크톱 환경에서는 화살표 키로 방향을 전환할 수 있다.

### 4. 기울기 조작
- **스토리**: 플레이어로서, 스마트폰을 기울여 캐릭터의 움직임을 직관적으로 제어하고 싶다.
- **수락 기준**:
  - DeviceOrientation API를 활용하여 베타/감마 값으로 이동 방향 벡터를 계산한다.
  - 기울기 값이 미미한 경우에는 직진을 유지하도록 데드존을 적용한다.
  - 데이터는 부드러운 보간을 통해 튀지 않고 반응한다.

### 5. 코인 생성
- **스토리**: 플레이어로서, 일정 시간마다 수집 가능한 코인이 나타나길 원한다.
- **수락 기준**:
  - 게임 시작 후 5초마다 빈 셀에서 코인이 하나씩 스폰된다.
  - 코인은 한 번에 최대 1개만 존재한다.
  - 코인이 생성될 때 캐릭터의 현재 경로를 차지하지 않는 위치여야 한다.

### 6. 코인 수집 및 성장
- **스토리**: 플레이어로서, 코인을 먹으면 캐릭터가 성장하길 원한다.
- **수락 기준**:
  - 캐릭터 헤드가 코인 반경에 진입하면 즉시 수집 처리된다.
  - 코인 1개를 수집할 때마다 캐릭터 길이가 1 세그먼트 증가한다.
  - 새로운 세그먼트는 기존 경로를 따라 부드럽게 이어진다.

### 7. 경로 기억
- **스토리**: 플레이어로서, 캐릭터가 이동한 경로 모양으로 몸체가 이어지길 원한다.
- **수락 기준**:
  - 캐릭터는 이동 궤적을 따라 세그먼트가 위치하며, 부드러운 곡선을 이룬다.
  - 경로 데이터는 일정 길이만 유지하고, 오래된 궤적은 순차적으로 제거된다.
  - 격자 경계를 벗어나지 않도록 카메라와 충돌 감지가 이루어진다.

### 8. 상태 표시 및 피드백
- **스토리**: 플레이어로서, 현재 점수와 안내를 즉시 확인하고 싶다.
- **수락 기준**:
  - 화면 상단에 현재 코인 수(점수)가 표시된다.
  - 센서 미지원 혹은 권한 거부 시 대체 입력(키보드) 안내가 제공된다.
  - 모바일 브라우저에서 FPS 저하 없이 안정적으로 동작해야 한다(목표 30fps 이상).

### 9. 실패 조건 및 재시작
- **스토리**: 플레이어로서, 캐릭터가 몸통과 충돌하면 게임이 종료되고 즉시 재시작할 수 있길 원한다.
- **수락 기준**:
  - 캐릭터 헤드가 두 번째 몸통 세그먼트를 제외한 자신의 세그먼트와 동일한 격자 셀을 점유하는 순간 게임이 종료된다.
  - 게임오버 시 점수 집계가 멈추고, 재시작 버튼이 포함된 팝업이 표시된다.
  - 재시작 버튼을 누르면 격자와 점수가 초기화되고 동일한 판에서 다시 시작한다.

## 비기능 요구 사항
- 반응형 UI: 세로/가로 화면 모두에서 UI가 무너지지 않는다.
- 성능: 16x16 격자 표시와 다중 세그먼트 렌더링 시 60fps 목표, 최소 30fps 유지.
- 접근성: 대비가 높은 HUD, 센서 권한 요청 버튼은 명확히 표시.
- 코드 품질: 모듈화된 함수 구조, 주석 및 설명 포함.

## 성공 지표
- 사용자가 1분 이상 게임을 플레이할 수 있는 안정성.
- 센서 권한 허용 후 즉각적인 방향 제어 응답성.
- 데스크톱 브라우저에서 키보드 기반 플레이가 가능함을 QA로 확인.
